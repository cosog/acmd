# 第十章 插件

- [第十章 插件](Chapter10.md#第十章-插件)
	- [10.1 采集处理](Chapter10.md#101-采集处理)
      - [10.1.1 输入文本](Chapter10.md#1011-输入文本)
      	- [10.1.1.1 输入参数说明](Chapter10.md#10111-输入参数说明)
      	- [10.1.1.2 输入实例](Chapter10.md#10112-输入实例)
	  - [10.1.2 输出文本](Chapter10.md#1012-输出文本)
      	- [10.1.2.1 输出参数说明](Chapter10.md#10121-输出参数说明)
      	- [10.1.2.2 输出实例](Chapter10.md#10122-输出实例)
      	- [10.1.2.3 诊断结果代码](Chapter10.md#10123-诊断结果代码)
	- [10.2 转直角坐标](Chapter10.md#102-采集处理)
      - [10.2.1 输入文本](Chapter10.md#1021-输入文本)
      	- [10.2.1.1 输入参数说明](Chapter10.md#10211-输入参数说明)
      	- [10.2.1.2 输入实例](Chapter10.md#10212-输入实例)
	  - [10.2.2 输出文本](Chapter10.md#1022-输出文本)
      	- [10.2.2.1 输出参数说明](Chapter10.md#10221-输出参数说明)
      	- [10.2.2.2 输出实例](Chapter10.md#10222-输出实例)		

## 10.1 采集处理
### 10.1.1 输入文本

#### 10.1.1.1 输入参数说明

*表10-1 输入参数说明表*

| 代码           | 名称                | 单位 | 类型    | 必填 | 备注                |
|----------------|---------------------|------|---------|------|---------------------|
| WellName       | 井名                |      | string  | *    |                     |
| NameplateStroke| 铭牌冲程            | m    | float64 | *    | 与前臂长二选一填写  |
| ForearmLength  | 前臂长              | m    | float64 |      | 与铭牌冲程二选一填写|
| Interval       | 采样间隔            | ms   | float64 |      |                     |
| **FADiagram**  | **载荷-角度数据**   |      |         |      |                     |
| AcquisitionTime| 采集时间            |      | string  | *    |                     |
| F              | 载荷                | kN   | float64 | *    |                     |
| A              | 角度                | °    | float64 | *    |                     |

#### 10.1.1.2 输入实例

```
{
"WellName": "01-020",       //（1）井名
"NameplateStroke": 4.35,    //（2）铭牌冲程
"ForearmLength": 4.2,       //（3）前臂长
"Interval": 66,             //（4）采集间隔
"FADiagram": {              //（5）载荷-角度参数
"AcquisitionTime": "2018-03-07 16:38:24", //（5-1）采集时间
"F": [    //（5-2）载荷
        62.14,
        61.93,
        61.71,
        61.71,
        61.32,
        ...
        62.63,
        62.68,
        62.68,
        62.79,
        62.79
    ],
"A": [    //（5-3）角度
        17.81,
        18.76,
        19.72,
        19.72,
        20.67,
        ...
        8.53,
        9.75,
        11.12,
        11.12,
        12.21,
        13.44
        ]
    }
}
```
### 10.1.2 输出文本

#### 10.1.2.1 输出参数说明

*表10-2 输出参数说明表*
| 代码                  | 名称             | 单位  | 类型    | 备注                              |
|-----------------------|------------------|-------|---------|-----------------------------------|
| WellName              | 井名             |       | string  |                                   |
| **CalculationStatus** | **计算状态**     |       |         |                                   |
| ResultStatus          | 计算结果状态     |       | int     | 详见表底注释[1]                   |
| ResultCode            | 诊断结果         |       | int     | 详见表10-3                           |
| **Verification**      | **数据校验**     |       |         |                                   |
| ErrorCounter          | 错误参数计数器   |       | int     | 错误参数个数                      |
| ErrorString           | 错误参数字符串   |       | string  | 数据错误，计算不成功              |
| WarningCounter        | 报警计数器       |       | int     | 报警参数个数                      |
| WarningString         | 报警字符串       |       | string  | 报警参数（取默认值，计算正常进行）|
| NameplateStroke       | 铭牌冲程         | m     | float64 |                                   |
| ForearmLength         | 前臂长           | m     | float64 |                                   |
| OptimizedInterval     | 优化采集间隔     | ms    | float64 |                                   |
| OptimizedCount        | 优化采集点数     |       | int     |                                   |
| **FSDiagram**         |  **功图数据**    |       |         |                                   |
| AcquisitionTime       | 采集时间         |       | string  |                                   |
| Stroke                | 功图冲程         | m     | float64 |                                   |
| SPM                   | 功图冲次         | 1/min | float64 |                                   |
| CNT                   | 点数             |       | int     |                                   |
| F                     | 载荷             | kN    | float64 |                                   |
| S                     | 位移             | m     | float64 |                                   |

**[1]** *1:计算成功，-44:请求数据读取失败，-55:请求数据json解码失败， -66:井数许可超限，-77:计算异常， -88:响应数据json编码失败， -99:数据校验错误* 

#### 10.1.2.2 输出实例

```
{
    "WellName": "01-020",       //（1）井名
    "CalculationStatus": {      //（2）计算状态
        "ResultStatus": 1,
        "ResultCode": 1102
    },
    "Verification": {           //（3）数据校验
        "ErrorCounter": 0,
        "ErrorString": "",
        "WarningCounter": 0,
        "WarningString": ""
    },
    "NameplateStroke": 4.35,    //（4）铭牌冲程
    "ForearmLength": 4.2,       //（5）前臂长
    "OptimizedInterval": 66,    //（6）优化采集间隔
    "OptimizedCount": 1200,     //（7）优化采集点数
    "FSDiagram": {              //（8）功图数据
        "AcquisitionTime": "2016-02-01 16:38:24", //（8-1）采集时间
        "Stroke": 4.35,             //（8-2）冲程
        "SPM": 4.5,                 //（8-3）冲次
        "CNT": 202,                 //（8-4）点数
        "F": [                      //（8-5）载荷
            37.5,
            37.5,
            37.5,
            38.27,
            38.27,
            38.86,
            39.07,
            ...
            37.48,
            37.48,
            37.17,
            37.43,
            37.43,
            37.82,
            38.09
        ],
        "S": [                       //（8-6）位移
            0,
            0,
            0,
            0,
            0,
            0,
            0.0103,
            ...
            0.13,
            0.13,
            0.0902,
            0.0601,
            0.0601,
            0.0301,
            0.0103
        ]
    }
}
```
#### 10.1.2.3 诊断结果代码

*表10-3 代码表*
| 序号 | 代码         | 说明                                    |
|------|--------------|-----------------------------------------|
| 1    | 1102         | 正常                                    |
| 2    | 1104         | 检查仪表                                |
| 3    | 1106         | 少于半个周期，优化重新采集              |
| 4    | 1107         | 少于1个周期，大于半个周期，优化重新采集 |
| 5    | 1108         | 功图点数少于目标点数下限，优化重新采集  |
| 6    | 1109         | 功图点数多于目标上限，优化重新采集      |
| 7    | 1302         | 停抽                                    |

## 10.2 转直角坐标

### 10.2.1 输入文本
#### 10.2.1.1 输入参数说明

表10-4 输入参数说明表

| **代码**                    | **名称** | **单位** | **类型** | **必填** | **备注** |
|-----------------------------|----------|----------|----------|----------|----------|
| **WellboreTrajectory**      | **井身轨迹**|          |          |          |          |
| MeasuringDepth              | 测量深度 | m        | float64  | *       |          |
| DeviationAngle              | 井斜角   | 度       | float64  | *       |          |
| AzimuthAngle                | 方位角   | 度       | float64  | *       |          |

#### 10.2.1.2 输入实例

```
{
    "AKString":"",
    "WellName":"2xyz",
    "WellboreTrajectory":{
        "MeasuringDepth":[
            115,
            120,
            125,
            130,
			...
            1635,
            1640,
            1645,
            1650
        ],
        "DeviationAngle":[
            0.2,
            0.17,
            0.2,
            0.2,
			...
            0.64,
            0.6,
            0.53,
            0.51
        ],
        "AzimuthAngle":[
            288.39,
            288.39,
            288.39,
            288.39,
			...
            74.85,
            75.31,
            80.74,
            91.04
        ]
    }
}
```

### 10.2.2 输出文本

#### 10.2.2.1 输出参数说明

表10-5 输出参数说明表

| **代码**                         | **名称**       | **单位** | **类型** | **备注**                                   |
|----------------------------------|----------------|----------|----------|----------------------------------------|
| WellName                         | 井名           |          | string   |                                        |
| **CalculationStatus**            | **计算状态**  |          |          |                                          |
| ResultStatus                     | 计算结果状态   |          | int      |  详见表底注释[1]                            |
| **Verification**                 | **数据校验**  |          |          |                                            |
| ErrorCounter                     | 错误参数计数器 |          | int      | 错误参数个数                                  |
| ErrorString                      | 错误参数字符串 |          | string   | 数据错误，计算不成功                          |
| WarningCounter                   | 报警计数器     |          | int      | 报警参数个数                                  |
| WarningString                    | 报警字符串     |          | string   | 报警参数（取默认值，计算正常进行）               |
| **WellboreTrajectory**           | **井身轨迹**   |          |          |                                            |
| CNT                              | 点数           |          | int      |                                            |
| MeasuringDepth                   | 测量深度       | m        | float64  |                                            |
| VerticalDepth                    | 垂直深度       | m        | float64  |                                            |
| DeviationAngle                   | 井斜角         | 度       | float64  |                                            |
| AzimuthAngle                     | 方位角         | 度       | float64  |                                            |
| X                                | 直角坐标X      | m        | float64  |                                            |
| Y                                | 直角坐标Y      | m        | float64  |                                            |
| Z                                | 直角坐标Z      | m        | float64  |                                            |
| ArrayStr                         | 数组字符串     |          | string   |                                            |

**[1]** *1:计算成功，-44:请求数据读取失败，-55:请求数据json解码失败， -66:井数许可超限，-77:计算异常， -88:响应数据json编码失败， -99:数据校验错误* 

#### 10.2.2.2 输出实例

```
{
    "WellName": "2xyz",
    "CalculationStatus": {
        "ResultStatus": 1
    },
    "Verification": {
        "ErrorCounter": 0,
        "ErrorString": "",
        "WarningCounter": 0,
        "WarningString": ""
    },
    "WellboreTrajectory": {
        "CNT": 308,
        "MeasuringDepth": [
            115,
            120,
            125,
            130,
			...
            1635,
            1640,
            1645,
            1650
        ],
        "VerticalDepth": [
            115,
            120,
            125,
            130,
			...
            1596.31,
            1601.31,
            1606.31,
            1611.31
        ],
        "DeviationAngle": [
            0.2,
            0.17,
            0.2,
            0.2,
			...
            0.64,
            0.6,
            0.53,
            0.51
        ],
        "AzimuthAngle": [
            288.39,
            288.39,
            288.39,
            288.39,
			...
            74.85,
            75.31,
            80.74,
            91.04
        ],
        "X": [
            -0.381,
            -0.395,
            -0.412,
            -0.428,
			...
            66.24,
            66.29,
            66.34,
            66.38
        ],
        "Y": [
            0.127,
            0.131,
            0.137,
            0.142,
			...
            264.99,
            265.01,
            265.01,
            265.01
        ],
        "Z": [
            115,
            120,
            125,
            130,
			...
            1596.31,
            1601.31,
            1606.31,
            1611.31
        ],
        "ArrayStr": "
        [
            -0.380924579344047,
            0.1266429051644481,
            -114.9992993806459
        ],
        [
            -0.395002234774901,
            0.13132318907980337,
            -119.99927737205346
        ],
		...
        [
            66.33980781815804,
            265.01450038745384,
            -1606.3112885584012
        ],
        [
            66.38430579490438,
            265.01369259708366,
            -1611.3110904822317
        ]
        "
    }
}
```


----[第九章 全井汇总](.././Chapter9/Chapter9.md)----[返回章节目录](.././README.md)----